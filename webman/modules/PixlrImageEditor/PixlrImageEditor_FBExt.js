/* Copyright (c) 2015 Synology Inc. All rights reserved. */

Ext.ns("SYNO.SDS.PixlrImageEditor");SYNO.SDS.PixlrImageEditor.FBExt={AllowExt:{editor:["jpg","jpeg","jpe","gif","png","psd","pxd"],express:["jpg","jpeg","jpe","gif","png"],picnik:["jpg","jpeg","jpe","gif","png","tga","tiff","xbm","ppm"]},basecheckFn:function(c,a,b){if(_S("demo_mode")||Ext.isIE6||Ext.isIE7||false===SYNO.SDS.Utils.Flash.isBaseSupport("10.0.0")){return false}if(1!==b.length||b[0].get("isdir")||(-1===c.indexOf(b[0].get("type").toLowerCase()))){return false}return true},checkEditFn:function(a,b){return SYNO.SDS.PixlrImageEditor.FBExt.basecheckFn(SYNO.SDS.PixlrImageEditor.FBExt.AllowExt.editor,a,b)},checkExpressFn:function(a,b){return SYNO.SDS.PixlrImageEditor.FBExt.basecheckFn(SYNO.SDS.PixlrImageEditor.FBExt.AllowExt.express,a,b)},checkPicnikFn:function(a,b){return SYNO.SDS.PixlrImageEditor.FBExt.basecheckFn(SYNO.SDS.PixlrImageEditor.FBExt.AllowExt.picnik,a,b)},launchFn:function(h,d){var b,a,c;var e=this.owner||this;var g=(("picnik"===h)?"Picnik":(("editor"===h)?"Pixlr Editor":"Pixlr Express"));b=SYNO.SDS.Utils.Network.getExternalHostName(true);if(!SYNO.SDS.Utils.Network.checkExternalIP(b)){var f=_S("rewrite_mode")?_T("error","external_ip_warning"):_T("error","external_ip_alert");if(!_S("is_admin")){f=_T("error","external_ip_normal_alert")}e.getMsgBox().alert(g,f,_S("rewrite_mode")?Ext.emptyFn:function(i){if("ok"==i){SYNO.SDS.AppLaunch("SYNO.SDS.AdminCenter.Application",{fn:"SYNO.SDS.AdminCenter.PublicAccess.Main",tab:"advancetab"})}},this);return}c=window.location.protocol+"//"+b;a=window.location.port;if(!_S("rewrite_mode")){if(window.location.protocol==="https:"){a=(_S("external_port_dsm_https")&&_S("external_port_dsm_https")!=="")?_S("external_port_dsm_https"):window.location.port}else{a=(_S("external_port_dsm_http")&&_S("external_port_dsm_http")!=="")?_S("external_port_dsm_http"):window.location.port}}if(a){c+=":"+a}SYNO.SDS.WindowLaunch("SYNO.SDS.PixlrImageEditor.Application",{path:d[0].get("file_id"),mode:h,herf:c})},launchEditFn:function(a){SYNO.SDS.PixlrImageEditor.FBExt.launchFn.call(this,"editor",a)},launchExpressFn:function(a){SYNO.SDS.PixlrImageEditor.FBExt.launchFn.call(this,"express",a)},launchPicnikFn:function(a){SYNO.SDS.PixlrImageEditor.FBExt.launchFn.call(this,"picnik",a)}};